<!DOCTYPE html>
<html>
  <head>
    <title>guanxi.html</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <script type="text/javascript" src="echart/echart-normal/echarts-all-3.js"></script>
    <script type="text/javascript" src="bootstrap/js/jquery.min.js"></script>
    <script type="text/javascript" src="echart/echart-normal/dataTool.min.js"></script>
    <script type="text/javascript">
    $(function(){
           function contains(arr, obj) {  
			    var i = arr.length;  
			    while (i--) {  
			        if (arr[i] === obj) {  
			            return true;  
			        }  
			    }  
			    return false;  
		    } 
	       var myChart = echarts.init(document.getElementById('main'));
	       
		    myChart.showLoading();
			$.get('data/compete-v6.gexf', function (xml) {
			    myChart.hideLoading();
			
			    var graph = echarts.dataTool.gexf.parse(xml);
			    var categories = [];
			    var i=0;
			    graph.nodes.forEach(function (node) {
			        node.itemStyle = null;
			        node.value = node.symbolSize;
			        node.symbolSize /= 1.5;
			        node.label = {
			            normal: {
			                show: node.symbolSize > 10
			            }
			        };
			        node.category = node.attributes.modularity_class;
			        if(!contains(categories,node.category)){
			           categories[i]=node.category;
			            i++;
			         }
			    });
			    
			   for (var i = 0; i < categories.length; i++) {
			        categories[i] = {
			            name: '分类' + i
			        };
			    }
			    option = {
			        title: {
			            text: '汽车产品竞争云图',
			            subtext: 'powerd by CIG-大数据中心',
			            top: 'top',
			            left: 'left'
			        },
			        tooltip: {},
			        toolbox: {
				        show : true,
				        feature : {
				            mark : {show: true},
				            dataView : {show: true, readOnly: false},
				            magicType : {show: true, type: ['line', 'bar', 'stack', 'tiled']},
				            restore : {show: true},
				            saveAsImage : {show: true}
				        }
				    },
			        legend: [{
			            data: categories.map(function (a) {
			                return a.name;
			            }),
			             orient: 'vertical',
			             x: 'right',
			             y:'40'
			        }],
			        animationDurationUpdate: 1500,
			        animationEasingUpdate: 'quinticInOut',
			        series : [
			            {
			                name: 'Les Miserables',
			                type: 'graph',
			                layout: 'circular',
			                circular: {
			                    rotateLabel: true
			                },
			                data: graph.nodes,
			                links: graph.links,
			                categories: categories,
			                roam: true,
			                label: {
			                    normal: {
			                        position: 'right',
			                        formatter: '{b}'
			                    }
			                },
			                focusNodeAdjacency: true,
			                lineStyle: {
			                    normal: {
			                        color: 'source',
			                        curveness: 0.3
			                    }
			                }
			            }
			        ]
			    };
			
			    myChart.setOption(option);
			}, 'xml');

		})
    </script>
  </head>
  <body>
      <div id="main" style="width:100%;height:600px;margin: 0px;padding: 0px"></div>
  </body>
</html>
